<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Font Animation Studio</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <script src="https://cdn.jsdelivr.net/npm/opentype.js@1.3.4/dist/opentype.min.js"></script>
</head>

<body>
    <div id="app">
        <!-- Top Menu Bar -->
        <div id="menuBar">
            <div class="menu-group">
                <button id="newBtn">New</button>
                <button id="openBtn">Open</button>
                <input type="file" id="openFileInput" accept=".json" style="display: none;">
                <button id="saveBtn">Save</button>
            </div>
            <div class="menu-group">
                <label for="canvasWidth">Width:</label>
                <input type="number" id="canvasWidth" value="1000" min="100">
                <label for="canvasHeight">Height:</label>
                <input type="number" id="canvasHeight" value="600" min="100">
                <label for="canvasBackground">Background:</label>
                <input type="color" id="canvasBackground" value="#ffffff">
                <label for="frameRate">FPS:</label>
                <input type="number" id="frameRate" value="30" min="1" max="120">
                <label for="duration">Duration (s):</label>
                <input type="number" id="duration" value="5" min="0.1" step="0.1">
            </div>
            <div class="menu-group">
                <div id="frameDisplay">
                    <span class="frame-label">Frame:</span>
                    <span id="currentFrameDisplay">0</span>
                    <span class="frame-separator">/</span>
                    <span id="totalFramesDisplay">150</span>
                </div>
                <div id="timeDisplay">
                    <span class="time-label">Time:</span>
                    <span id="currentTimeDisplay">0s+0f</span>
                </div>
                <button id="aboutBtn" title="About Font Animation Studio">About</button>
            </div>
        </div>

        <!-- Main Content Area -->
        <div id="mainContent">
            <!-- Left Toolbar -->
            <div id="leftToolbar">
                <div class="tool-group">
                    <button id="handTool" class="tool-btn active" title="Hand Tool (H)">
                        <span class="material-symbols-outlined">pan_tool</span>
                    </button>
                    <button id="zoomTool" class="tool-btn" title="Zoom Tool (Z)">
                        <span class="material-symbols-outlined">search</span>
                    </button>
                    <button id="textTool" class="tool-btn" title="Text Tool (T)">
                        <span class="material-symbols-outlined">text_fields</span>
                    </button>
                    <button id="selectTool" class="tool-btn" title="Select Tool (V)">
                        <span class="material-symbols-outlined">near_me</span>
                    </button>
                </div>
                <div class="tool-group">
                    <button id="playBtn" class="tool-btn" title="Play/Pause (Space)">
                        <span class="material-symbols-outlined">play_arrow</span>
                    </button>
                    <button id="exportBtn" class="tool-btn" title="Export Video (Cmd+E)">
                        <span class="material-symbols-outlined">videocam</span>
                    </button>
                </div>
                <div class="tool-group">
                    <button id="undoBtn" class="tool-btn" title="Undo (Cmd+Z)">
                        <span class="material-symbols-outlined">undo</span>
                    </button>
                    <button id="redoBtn" class="tool-btn" title="Redo (Cmd+Shift+Z)">
                        <span class="material-symbols-outlined">redo</span>
                    </button>
                </div>
                <div class="tool-group">
                    <label for="fontUpload" class="upload-btn">Upload Fonts</label>
                    <input type="file" id="fontUpload" multiple accept=".otf,.ttf,.woff,.woff2" style="display: none;">
                    <div id="fontList"></div>
                </div>
            </div>

            <!-- Canvas Area -->
            <div id="canvasContainer">
                <div id="canvasBackground">
                    <canvas id="mainCanvas"></canvas>
                </div>
                <div id="canvasOverlay"></div>
            </div>

            <!-- Right Panel -->
            <div id="rightPanel">
                <div id="textProperties" style="display: none;">
                    <h3>Text Properties</h3>
                    <div class="property-group">
                        <label>Font:</label>
                        <select id="fontSelect"></select>
                    </div>
                    <div class="property-group">
                        <label>Size:</label>
                        <input type="number" id="fontSize" value="48" min="1">
                    </div>
                    <div class="property-group">
                        <label>Color:</label>
                        <input type="color" id="fontColor" value="#000000">
                    </div>
                    <div class="property-group">
                        <label>Position X:</label>
                        <input type="number" id="textX" value="0" step="0.1">
                    </div>
                    <div class="property-group">
                        <label>Position Y:</label>
                        <input type="number" id="textY" value="0" step="0.1">
                    </div>
                    <div class="property-group">
                        <label>Text:</label>
                        <textarea id="textContent" rows="3"></textarea>
                    </div>
                    <div id="variableAxes"></div>
                    <div id="openTypeFeatures"></div>
                </div>
                <div id="interpolationPanel" style="display: none;">
                    <h3>Interpolation Curve</h3>
                    <canvas id="curveEditor" width="200" height="200"></canvas>
                    <div class="curve-controls">
                        <button id="resetCurve">Reset to Linear</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Timeline -->
        <div id="timeline">
            <div id="timelineLayout">
                <!-- Fixed layer names column -->
                <div id="timelineLeftColumn">
                    <div id="timelineHeaderLeft">
                        <div class="layer-names-header">Layers</div>
                    </div>
                    <div id="timelineLayerNames"></div>
                </div>

                <!-- Scrollable timeline content -->
                <div id="timelineRightColumn">
                    <div id="timelineContainer">
                        <div id="timelineContent">
                            <div id="timelineHeader">
                                <div id="timeRuler">
                                    <div id="timeCursor"></div>
                                </div>
                            </div>
                            <div id="timelineLayers"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Warning Modal -->
    <div id="warningModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Missing Fonts</h2>
            <p>The following fonts are missing and need to be uploaded:</p>
            <ul id="missingFontsList"></ul>
            <button id="continueAnyway">Continue Anyway</button>
        </div>
    </div>

    <!-- Export Format Modal -->
    <div id="exportFormatModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Export Video</h2>
            <p>Choose your preferred video format:</p>
            <div id="formatOptions">
                <!-- Format options will be populated dynamically -->
            </div>
            <div class="modal-buttons">
                <button id="cancelExport">Cancel</button>
                <button id="confirmExport" disabled>Export</button>
            </div>
        </div>
    </div>

    <!-- About Modal -->
    <div id="aboutModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>About Font Animation Studio</h2>
            <div class="about-content">
                <p>Font Animation Studio is a professional typography animation tool that lets you create stunning text
                    animations with OpenType features and advanced timeline controls of variable font axes.</p>

                <h3>Features</h3>
                <ul>
                    <li>Advanced typography with OpenType feature support</li>
                    <li>Professional timeline with keyframe animation</li>
                    <li>Multiple video export formats (WebM, MP4)</li>
                    <li>Font upload and management</li>
                    <li>Interpolation curves for smooth animations</li>
                    <li>Variable font axis control</li>
                </ul>

                <h3>Keyboard Shortcuts</h3>
                <div class="shortcuts-grid">
                    <div><kbd>Space</kbd> Play/Pause</div>
                    <div><kbd>←/→</kbd> Navigate frames</div>
                    <div><kbd>Cmd+←/→</kbd> First/Last frame</div>
                    <div><kbd>Cmd+E</kbd> Export video</div>
                    <div><kbd>Cmd+Z</kbd> Undo/Redo</div>
                    <div><kbd>Esc</kbd> Close modals</div>
                </div>

                <div class="about-footer">
                    <p>Open source project available on GitHub:</p>
                    <a href="https://github.com/yanone/fontanimation" target="_blank" rel="noopener noreferrer"
                        class="github-link">
                        <span class="material-symbols-outlined">open_in_new</span>
                        github.com/yanone/fontanimation
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script src="js/settings.js"></script>
    <script src="js/main.js"></script>
    <script src="js/fonts.js"></script>
    <script src="js/timeline.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/animation.js"></script>
    <script src="js/export.js"></script>
    <script src="js/canvas.js"></script>
    <script src="js/tools.js"></script>
</body>

</html>